{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "benchmark.schema.json",
  "title": "Benchmark Schema",
  "description": "Schema for customer benchmarks used to evaluate Parallel.ai against competitor systems",
  "type": "object",
  "required": ["id", "customer", "questions"],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^benchmark-[0-9]{8}_[0-9]{6}-[a-f0-9]{6}$",
      "description": "Unique benchmark identifier"
    },
    "customer": {
      "type": "string",
      "minLength": 1,
      "description": "Customer/company name this benchmark is for"
    },
    "use_case": {
      "type": "string",
      "description": "Primary use case or focus area for this benchmark"
    },
    "status": {
      "type": "string",
      "enum": ["created", "in_progress", "completed", "failed", "paused"],
      "default": "created",
      "description": "Current status of the benchmark"
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "When the benchmark was created"
    },
    "metadata": {
      "type": "object",
      "description": "Additional metadata about the benchmark",
      "properties": {
        "validation_issues": {
          "type": "array",
          "items": {"type": "string"},
          "description": "Issues found during validation"
        },
        "created_by": {
          "type": "string",
          "description": "Who/what created this benchmark"
        },
        "version": {
          "type": "string",
          "description": "Schema version"
        }
      }
    },
    "customer_research": {
      "type": "object",
      "description": "Research data about the customer that informed question generation",
      "properties": {
        "company_overview": {
          "type": ["string", "object", "null"],
          "description": "General company information"
        },
        "industry": {
          "type": ["string", "object", "null"],
          "description": "Industry classification"
        },
        "products_services": {
          "type": ["string", "array", "object", "null"],
          "description": "Products and services offered"
        },
        "target_market": {
          "type": ["string", "array", "object", "null"],
          "description": "Target market segments"
        },
        "challenges": {
          "type": ["string", "array", "object", "null"],
          "description": "Business challenges identified"
        },
        "potential_use_cases": {
          "type": ["string", "array", "object", "null"],
          "description": "Use cases for Parallel.ai"
        },
        "raw_output": {
          "type": "object",
          "description": "Raw API response from research"
        },
        "researched_at": {
          "type": "string",
          "format": "date-time"
        }
      }
    },
    "identified_use_cases": {
      "type": "array",
      "items": {"type": "string"},
      "description": "List of use case names identified from research"
    },
    "questions": {
      "type": "array",
      "minItems": 1,
      "description": "Benchmark questions",
      "items": {
        "$ref": "#/definitions/question"
      }
    }
  },
  "definitions": {
    "question": {
      "type": "object",
      "required": ["id", "text", "category", "difficulty"],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^q-[0-9]{3}$",
          "description": "Unique question identifier within benchmark"
        },
        "text": {
          "type": "string",
          "minLength": 10,
          "description": "The question text"
        },
        "category": {
          "type": "string",
          "enum": ["search", "enrichment", "research"],
          "description": "Question category based on API capability"
        },
        "difficulty": {
          "type": "string",
          "enum": ["easy", "medium", "hard"],
          "description": "Question difficulty level"
        },
        "expected_answer_type": {
          "type": "string",
          "enum": ["factual", "list", "analysis", "comparison", "summary"],
          "default": "factual",
          "description": "Expected type of answer"
        },
        "context": {
          "type": ["string", "null"],
          "description": "Additional context for the question"
        },
        "ground_truth": {
          "type": ["string", "null"],
          "description": "Known correct answer if available"
        },
        "evaluation_criteria": {
          "type": "array",
          "items": {"type": "string"},
          "description": "Criteria for evaluating answer quality"
        },
        "metadata": {
          "type": "object",
          "description": "Additional question metadata",
          "properties": {
            "use_case": {"type": "string"},
            "customer": {"type": "string"},
            "fallback": {"type": "boolean"},
            "extra": {"type": "boolean"}
          }
        }
      }
    },
    "result": {
      "type": "object",
      "required": ["id", "benchmark_id", "system", "answers"],
      "description": "Results from running a benchmark",
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^result-[a-z]+-[0-9]{8}_[0-9]{6}-[a-f0-9]{6}$",
          "description": "Unique result identifier"
        },
        "benchmark_id": {
          "type": "string",
          "description": "ID of the benchmark that was run"
        },
        "system": {
          "type": "string",
          "description": "System identifier (parallel or competitor name)"
        },
        "status": {
          "type": "string",
          "enum": ["created", "in_progress", "completed", "failed", "paused"],
          "default": "in_progress"
        },
        "started_at": {
          "type": "string",
          "format": "date-time"
        },
        "completed_at": {
          "type": ["string", "null"],
          "format": "date-time"
        },
        "processor": {
          "type": "string",
          "enum": ["lite", "base", "core", "core2x", "pro", "ultra", "ultra2x", "ultra4x", "ultra8x"],
          "default": "base",
          "description": "Parallel processor tier used"
        },
        "total_latency_ms": {
          "type": "integer",
          "minimum": 0
        },
        "total_tokens": {
          "type": "integer",
          "minimum": 0
        },
        "success_count": {
          "type": "integer",
          "minimum": 0
        },
        "error_count": {
          "type": "integer",
          "minimum": 0
        },
        "config": {
          "type": "object",
          "description": "Configuration used for this run"
        },
        "answers": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/answer"
          }
        }
      }
    },
    "answer": {
      "type": "object",
      "required": ["question_id"],
      "properties": {
        "question_id": {
          "type": "string",
          "description": "ID of the question this answers"
        },
        "answer": {
          "type": "string",
          "description": "The answer text"
        },
        "raw_response": {
          "type": "object",
          "description": "Full API response"
        },
        "latency_ms": {
          "type": "integer",
          "minimum": 0
        },
        "tokens_used": {
          "type": "integer",
          "minimum": 0
        },
        "sources": {
          "type": "array",
          "items": {"type": "string"},
          "description": "URLs or references used"
        },
        "error": {
          "type": ["string", "null"],
          "description": "Error message if failed"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time"
        }
      }
    },
    "evaluation": {
      "type": "object",
      "required": ["id", "benchmark_id", "parallel_result_id", "comparison_result_id"],
      "description": "Evaluation comparing two benchmark results",
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^eval-[0-9]{8}_[0-9]{6}-[a-f0-9]{6}$"
        },
        "benchmark_id": {
          "type": "string"
        },
        "parallel_result_id": {
          "type": "string"
        },
        "comparison_result_id": {
          "type": "string"
        },
        "comparison_system": {
          "type": "string"
        },
        "winner": {
          "type": "string",
          "enum": ["parallel", "comparison", "tie", "inconclusive"]
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "created_at": {
          "type": "string",
          "format": "date-time"
        },
        "summary": {
          "type": "string"
        },
        "strengths_parallel": {
          "type": "array",
          "items": {"type": "string"}
        },
        "strengths_comparison": {
          "type": "array",
          "items": {"type": "string"}
        },
        "aggregate_scores": {
          "$ref": "#/definitions/aggregate_scores"
        },
        "question_scores": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/question_score"
          }
        }
      }
    },
    "aggregate_scores": {
      "type": "object",
      "properties": {
        "parallel_average": {
          "type": "number",
          "minimum": 0,
          "maximum": 10
        },
        "comparison_average": {
          "type": "number",
          "minimum": 0,
          "maximum": 10
        },
        "by_category": {
          "type": "object",
          "additionalProperties": {
            "type": "object",
            "properties": {
              "parallel": {"type": "number"},
              "comparison": {"type": "number"}
            }
          }
        },
        "by_difficulty": {
          "type": "object",
          "additionalProperties": {
            "type": "object",
            "properties": {
              "parallel": {"type": "number"},
              "comparison": {"type": "number"}
            }
          }
        },
        "parallel_wins": {
          "type": "integer",
          "minimum": 0
        },
        "comparison_wins": {
          "type": "integer",
          "minimum": 0
        },
        "ties": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "question_score": {
      "type": "object",
      "required": ["question_id", "parallel_score", "comparison_score", "winner"],
      "properties": {
        "question_id": {
          "type": "string"
        },
        "parallel_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 10
        },
        "comparison_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 10
        },
        "accuracy_parallel": {
          "type": "number",
          "minimum": 0,
          "maximum": 10
        },
        "accuracy_comparison": {
          "type": "number",
          "minimum": 0,
          "maximum": 10
        },
        "completeness_parallel": {
          "type": "number",
          "minimum": 0,
          "maximum": 10
        },
        "completeness_comparison": {
          "type": "number",
          "minimum": 0,
          "maximum": 10
        },
        "relevance_parallel": {
          "type": "number",
          "minimum": 0,
          "maximum": 10
        },
        "relevance_comparison": {
          "type": "number",
          "minimum": 0,
          "maximum": 10
        },
        "winner": {
          "type": "string",
          "enum": ["parallel", "comparison", "tie", "inconclusive"]
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "reasoning": {
          "type": "string"
        }
      }
    }
  }
}
